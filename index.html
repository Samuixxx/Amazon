<form id="upload-form" action="https://localhost:8433/api/products/createProduct">
    <input type="text" name="name" placeholder="Name" required value="Monopattino Elettrico Pieghevole per Pendolari" />
    <input type="text" name="vendor" placeholder="Vendor" required value="UrbanGlide" />
    <label for="description">Description (JSON):</label>
    <textarea name="description" rows="10" cols="50" required>
{
  "en": "Foldable electric scooter for efficient urban commuting, offering a fast and eco-friendly ride.",
  "it": "Monopattino elettrico pieghevole per pendolari urbani efficienti, offre una guida veloce ed ecologica.",
  "es": "Patinete elÃ©ctrico plegable para desplazamientos urbanos eficientes, que ofrece un viaje rÃ¡pido y ecolÃ³gico.",
  "fr": "Trottinette Ã©lectrique pliable pour les dÃ©placements urbains efficaces, offrant une conduite rapide et Ã©cologique.",
  "de": "Faltbarer Elektroroller fÃ¼r effizientes Pendeln in der Stadt, der eine schnelle und umweltfreundliche Fahrt bietet.",
  "cn": "å¯æŠ˜å ç”µåŠ¨æ»‘æ¿è½¦ï¼Œé«˜æ•ˆåŸå¸‚é€šå‹¤ï¼Œæä¾›å¿«é€Ÿç¯ä¿çš„éª‘è¡Œä½“éªŒã€‚"
}
    </textarea>
    <label for="specifications">Specifications (JSON):</label>
    <textarea name="specifications" rows="10" cols="50" required>
{
  "en": "25km/h max speed, 30km range, 350W motor, disc brakes, LED display, lightweight aluminum frame.",
  "it": "VelocitÃ  massima 25 km/h, autonomia 30 km, motore 350W, freni a disco, display LED, telaio leggero in alluminio.",
  "es": "Velocidad mÃ¡xima de 25 km/h, autonomÃ­a de 30 km, motor de 350W, frenos de disco, pantalla LED, cuadro ligero de aluminio.",
  "fr": "Vitesse max 25 km/h, autonomie 30 km, moteur 350W, freins Ã  disque, Ã©cran LED, cadre en aluminium lÃ©ger.",
  "de": "25 km/h HÃ¶chstgeschwindigkeit, 30 km Reichweite, 350W Motor, Scheibenbremsen, LED-Anzeige, leichter Aluminiumrahmen.",
  "cn": "æœ€é«˜æ—¶é€Ÿ25å…¬é‡Œ/å°æ—¶ï¼Œç»­èˆª30å…¬é‡Œï¼Œ350Wç”µæœºï¼Œç¢Ÿåˆ¹ï¼ŒLEDæ˜¾ç¤ºå±ï¼Œè½»è´¨é“åˆé‡‘è½¦æ¶ã€‚"
}
    </textarea>
    <input type="number" name="price" placeholder="Price" step="0.01" required value="499.00" />
    <input type="number" name="quantity" placeholder="Quantity" required value="60" />
    <input type="file" name="images" multiple />
    <input type="file" name="models" />
    <input type="text" name="subcategory_id" value="102" hidden>
    <button type="submit">Upload Product</button>
</form>

<script>
    document.getElementById('upload-form').addEventListener('submit', async function (e) {
        e.preventDefault();

        const form = e.target;
        const formData = new FormData(form);

        try {
            const response = await fetch(form.action, {
                method: 'POST',
                body: formData
            });

            let result;

            // Verifica che la risposta sia in formato JSON
            const contentType = response.headers.get("content-type");
            if (contentType && contentType.includes("application/json")) {
                result = await response.json();
            } else {
                // Se non Ã¨ JSON, leggi il testo (probabilmente HTML)
                const text = await response.text();
                console.error("Risposta non JSON:", text);
                alert("Errore: Il server ha restituito una risposta non valida.");
                return;
            }

            if (response.ok) {
                alert(result.message || 'âœ… Prodotto caricato con successo');
                form.reset();
            } else {
                alert(result.error || 'âŒ Errore durante il caricamento: ' + (result.details || result.message));
            }
        } catch (err) {
            console.error('ğŸš¨ Errore nella richiesta:', err);
            alert('âš ï¸ Richiesta fallita: ' + err.message);
        }
    });
</script>